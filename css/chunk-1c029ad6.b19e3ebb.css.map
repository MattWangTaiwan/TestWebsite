{"version":3,"sources":["webpack:///src/views/Member/src/views/Member/AssociationTemplate.vue"],"names":[],"mappings":"AAoFA,+BACA,UAAA,CACA,YACA","file":"chunk-1c029ad6.b19e3ebb.css","sourcesContent":["<template>\n  <iframe class=\"iframe-panel\" v-if=\"isAssociated\"\n          :src=\"`https://www.public.com.tw/member-certification/4010/${stateUserId}`\"></iframe>\n<!--  <iframe src=\"https://mattwangtaiwan.github.io/iframe.html\"></iframe>-->\n</template>\n\n<script lang=\"ts\">\nimport Swal from 'sweetalert2';\nimport { Component, Vue } from 'vue-property-decorator';\nimport { Action, State } from 'vuex-class';\nimport { IInputInfo, ILoginPayload } from '@/types/interface';\n\n@Component\nexport default class AssociationTemplate extends Vue {\n  @State('userId') stateUserId!: string;\n  @State('source') stateSource!: string;\n  @State('approveKey') stateApproveKey!: string;\n  @State('phone') statePhone!: string;\n  @State('email') stateEmail!: string;\n  @State('name') stateName!: string;\n  @Action('addMember') addMember!: (params: IInputInfo) => Promise<ILoginPayload>;\n\n  isAssociated = false;\n\n  get isMemberProcess() {\n    return this.$route.query.process === 'member';\n  }\n\n  created() {\n    if (this.isMemberProcess) {\n      this.isAssociated = true;\n      window.addEventListener('message', this.receiveMessage, false);\n    } else {\n      Swal.fire({\n        width: 300,\n        showCloseButton: false,\n        showCancelButton: true,\n        background: '#FFFFFF',\n        title: '是否關聯公職王帳號',\n        text: '',\n        customClass: {\n          title: 'modal-title',\n          content: 'modal-content',\n          confirmButton: 'modal-confirm-button-half',\n          cancelButton: 'modal-cancel-button-half',\n        },\n        confirmButtonText: '關聯',\n        cancelButtonText: '略過',\n        reverseButtons: true,\n      }).then((res) => {\n        if (res.isConfirmed) {\n          this.isAssociated = true;\n          window.addEventListener('message', this.receiveMessage, false);\n        } else this.$router.push('/login/set_member_profile');\n      });\n    }\n  }\n\n  receiveMessage(e: any) {\n    if (e.origin === 'https://www.public.com.tw') {\n      const params = {\n        Status: '1',\n        UserGuid: this.stateUserId,\n        PID: e.data.Data.id,\n        Source: this.stateSource,\n        // eslint-disable-next-line\n        Approve_Key: this.stateSource === 'CF01' || this.stateSource === 'CF02' ? this.stateApproveKey : undefined,\n        Email: this.stateSource === 'CF01' || this.stateSource === 'CF02' ? this.stateEmail : undefined,\n        Name: this.stateSource === 'CF01' || this.stateSource === 'CF02' ? this.stateName : undefined,\n        Mobile: this.stateSource === 'CF05' ? this.statePhone : undefined,\n      };\n      this.addMember(params)\n        .then((data: ILoginPayload) => {\n          if (data.Code === '0000') {\n            if (this.isMemberProcess) this.$router.push('/member/edit_profile');\n            else this.$router.push('/login/set_member_profile');\n          }\n        });\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .iframe-panel {\n    width: 100%;\n    height: 100vh;\n  }\n</style>\n"]}